<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with CEAS • ceas</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started with CEAS">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ceas</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ceas.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/atp_calculation.html">ATP calculation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jamespeapen/ceas/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting started with CEAS</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jamespeapen/ceas/blob/dev/vignettes/ceas.Rmd" class="external-link"><code>vignettes/ceas.Rmd</code></a></small>
      <div class="d-none name"><code>ceas.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jamespeapen.github.io/ceas/">ceas</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="importing-seahorse-rates-data">Importing Seahorse rates data<a class="anchor" aria-label="anchor" href="#importing-seahorse-rates-data"></a>
</h2>
<p>The <code>read_data</code> function takes a list of Excel files. An
easy way to get such a list is to put all your data in a directory and
list its contents. Here we use the package’s internal datasets, but
<code>list.files</code> will take a directory name as its first
argument.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ceas"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"*.xlsx"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">rep_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">raw_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="18%">
<col width="7%">
<col width="19%">
<col width="13%">
<col width="13%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="right">Measurement</th>
<th align="left">Well</th>
<th align="left">Group</th>
<th align="right">Time</th>
<th align="right">OCR</th>
<th align="right">ECAR</th>
<th align="right">PER</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A01</td>
<td align="left">Background</td>
<td align="right">1.304765</td>
<td align="right">0.0000</td>
<td align="right">0.00000</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A02</td>
<td align="left">Group_1 MITO</td>
<td align="right">1.304765</td>
<td align="right">305.2426</td>
<td align="right">30.64529</td>
<td align="right">334.4771</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">A03</td>
<td align="left">Group_1 MITO</td>
<td align="right">1.304765</td>
<td align="right">307.9862</td>
<td align="right">33.27668</td>
<td align="right">358.4754</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A04</td>
<td align="left">Group_2 MITO</td>
<td align="right">1.304765</td>
<td align="right">339.3399</td>
<td align="right">49.17751</td>
<td align="right">503.4910</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">A05</td>
<td align="left">Group_2 MITO</td>
<td align="right">1.304765</td>
<td align="right">321.9398</td>
<td align="right">47.94602</td>
<td align="right">492.2597</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A06</td>
<td align="left">Group_2 MITO</td>
<td align="right">1.304765</td>
<td align="right">323.7962</td>
<td align="right">46.84232</td>
<td align="right">482.1940</td>
</tr>
</tbody>
</table>
<p>The data requires the following columns: Measurement, Well, Group,
Time, OCR, ECAR, PER. The <code>Group</code> column needs to be in the
format <code>biological_group&lt;space&gt;Assay_type</code> as shown
above. Upon reading with <code>read_data</code>, the <code>Group</code>
column is split into two <code>group</code> and <code>assay</code>
columns on the space. This output format can be set in the Seahorse
machine before starting the experiment. If you already have the data,
this column will have to be converted to this format to work with
ceas.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seahorse_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_data.html">read_data</a></span><span class="op">(</span><span class="va">rep_list</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seahorse_rates</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="5%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="12%">
<col width="12%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="right">Measurement</th>
<th align="left">Well</th>
<th align="right">Time</th>
<th align="right">OCR</th>
<th align="right">ECAR</th>
<th align="right">PER</th>
<th align="left">exp_group</th>
<th align="left">assay_type</th>
<th align="right">replicate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A01</td>
<td align="right">1.304765</td>
<td align="right">0.0000</td>
<td align="right">0.00000</td>
<td align="right">0.0000</td>
<td align="left">Background</td>
<td align="left">NA</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A02</td>
<td align="right">1.304765</td>
<td align="right">305.2426</td>
<td align="right">30.64529</td>
<td align="right">334.4771</td>
<td align="left">Group_1</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">A03</td>
<td align="right">1.304765</td>
<td align="right">307.9862</td>
<td align="right">33.27668</td>
<td align="right">358.4754</td>
<td align="left">Group_1</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A04</td>
<td align="right">1.304765</td>
<td align="right">339.3399</td>
<td align="right">49.17751</td>
<td align="right">503.4910</td>
<td align="left">Group_2</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">A05</td>
<td align="right">1.304765</td>
<td align="right">321.9398</td>
<td align="right">47.94602</td>
<td align="right">492.2597</td>
<td align="left">Group_2</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A06</td>
<td align="right">1.304765</td>
<td align="right">323.7962</td>
<td align="right">46.84232</td>
<td align="right">482.1940</td>
<td align="left">Group_2</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="normalization">Normalization<a class="anchor" aria-label="anchor" href="#normalization"></a>
</h3>
<p>There are two types of normalization involved in Seahorse data
analysis. One is background normalization done by the Wave software.
<em>ceas</em> will produce a warning if it finds that the “Background”
data are not 0 (see first row of the table above).</p>
<p>The other is biological normalization based on the cell count or the
mass of protein. If the data is not already biologically normalized, you
will need a csv file containing experimental groups and cell counts or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>g
of protein in this format:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">norm_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ceas"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"norm.csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">norm_csv</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">exp_group</th>
<th align="right">measure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Group_1</td>
<td align="right">30000</td>
</tr>
<tr class="even">
<td align="left">Group_2</td>
<td align="right">30000</td>
</tr>
<tr class="odd">
<td align="left">Group_3</td>
<td align="right">5000</td>
</tr>
<tr class="even">
<td align="left">Group_4</td>
<td align="right">5000</td>
</tr>
</tbody>
</table>
<p>Your csv file’s full path may be passed into <code><a href="../reference/read_data.html">read_data()</a></code>
using the <code>norm</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_data.html">read_data</a></span><span class="op">(</span><span class="va">rep_list</span>, norm <span class="op">=</span> <span class="va">norm_csv</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="5%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="12%">
<col width="12%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="right">Measurement</th>
<th align="left">Well</th>
<th align="right">Time</th>
<th align="right">OCR</th>
<th align="right">ECAR</th>
<th align="right">PER</th>
<th align="left">exp_group</th>
<th align="left">assay_type</th>
<th align="right">replicate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A01</td>
<td align="right">1.304765</td>
<td align="right">0.00000</td>
<td align="right">0.000000</td>
<td align="right">0.00000</td>
<td align="left">Background</td>
<td align="left">NA</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A02</td>
<td align="right">1.304765</td>
<td align="right">50.87376</td>
<td align="right">5.107549</td>
<td align="right">55.74619</td>
<td align="left">Group_1</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">A03</td>
<td align="right">1.304765</td>
<td align="right">51.33103</td>
<td align="right">5.546114</td>
<td align="right">59.74590</td>
<td align="left">Group_1</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A04</td>
<td align="right">1.304765</td>
<td align="right">56.55665</td>
<td align="right">8.196252</td>
<td align="right">83.91516</td>
<td align="left">Group_2</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">A05</td>
<td align="right">1.304765</td>
<td align="right">53.65663</td>
<td align="right">7.991003</td>
<td align="right">82.04329</td>
<td align="left">Group_2</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">A06</td>
<td align="right">1.304765</td>
<td align="right">53.96603</td>
<td align="right">7.807053</td>
<td align="right">80.36566</td>
<td align="left">Group_2</td>
<td align="left">MITO</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="calculating-energetics">Calculating energetics<a class="anchor" aria-label="anchor" href="#calculating-energetics"></a>
</h2>
<div class="section level3">
<h3 id="partitioning-data">Partitioning data<a class="anchor" aria-label="anchor" href="#partitioning-data"></a>
</h3>
<p><strong>Note:</strong><br>
When we use the term ‘max’ in the package documentation we mean the
maximal experimental OCR and ECAR values rather than absolute biological
maximums.</p>
<p>The energetics calculation workflow involves partitioning the data
into its time point and assay intervals.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">partitioned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/partition_data.html">partition_data</a></span><span class="op">(</span><span class="va">seahorse_rates</span><span class="op">)</span></span></code></pre></div>
<div class="section level4 tabset">
<h4 class="tabset" id="alternative-data-formats">Alternative data formats<a class="anchor" aria-label="anchor" href="#alternative-data-formats"></a>
</h4>
<p>While the default options are set for an experiment with both a
mitochondrial and glycolysis assay, if you have only a mitochondrial
assay or no glycolysis assay, the <code>assay_types</code> list
parameter can be modified to account for that.</p>




<ul class="nav nav-tabs" id="alternative-data-formats" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#mito-glyco-our-default" id="mito-glyco-our-default-tab" type="button" role="tab" aria-controls="mito-glyco-our-default" aria-selected="true" class="active nav-link">Mito + Glyco (our default)</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#data-in-the-form-of-mookerjee2017" id="data-in-the-form-of-mookerjee2017-tab" type="button" role="tab" aria-controls="data-in-the-form-of-mookerjee2017" aria-selected="false" class="nav-link">Data in the form of <span class="citation">Mookerjee et al. (<a href="#ref-mookerjee2017">2017</a>)</span></button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#just-mito" id="just-mito-tab" type="button" role="tab" aria-controls="just-mito" aria-selected="false" class="nav-link">Just Mito</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#respiratory-control-ratio-rcr-and-glycolytic-capacity-gc-assay" id="respiratory-control-ratio-rcr-and-glycolytic-capacity-gc-assay-tab" type="button" role="tab" aria-controls="respiratory-control-ratio-rcr-and-glycolytic-capacity-gc-assay" aria-selected="false" class="nav-link">Respiratory control ratio (RCR) and glycolytic capacity (GC)
assay</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="mito-glyco-our-default" role="tabpanel" aria-labelledby="mito-glyco-our-default-tab">

<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">partitioned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/partition_data.html">partition_data</a></span><span class="op">(</span></span>
<span>  <span class="va">seahorse_rates</span>,</span>
<span>  assay_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    basal <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    uncoupled <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    maxresp <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    nonmito <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    no_glucose_glyc <span class="op">=</span> <span class="st">"GLYCO"</span>,</span>
<span>    glucose_glyc <span class="op">=</span> <span class="st">"GLYCO"</span>,</span>
<span>    max_glyc <span class="op">=</span> <span class="st">"GLYCO"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  basal_tp <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  uncoupled_tp <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  maxresp_tp <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  nonmito_tp <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  no_glucose_glyc_tp <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  glucose_glyc_tp <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  max_glyc_tp <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="data-in-the-form-of-mookerjee2017" role="tabpanel" aria-labelledby="data-in-the-form-of-mookerjee2017-tab">

<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">partitioned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/partition_data.html">partition_data</a></span><span class="op">(</span></span>
<span>  <span class="va">seahorse_rates</span>,</span>
<span>  assay_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    basal <span class="op">=</span> <span class="st">"RefAssay"</span>,</span>
<span>    uncoupled <span class="op">=</span> <span class="st">"RefAssay"</span>,</span>
<span>    maxresp <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    nonmito <span class="op">=</span> <span class="st">"RefAssay"</span>,</span>
<span>    no_glucose_glyc <span class="op">=</span> <span class="st">"RefAssay"</span>,</span>
<span>    glucose_glyc <span class="op">=</span> <span class="st">"RefAssay"</span>,</span>
<span>    max_glyc <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span>,</span>
<span>  basal_tp <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  uncoupled_tp <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nonmito_tp <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  maxresp <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  no_glucose_glyc_tp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  glucose_glyc_tp <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  max_glyc <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="just-mito" role="tabpanel" aria-labelledby="just-mito-tab">

<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">partitioned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/partition_data.html">partition_data</a></span><span class="op">(</span></span>
<span>  <span class="va">seahorse_rates</span>,</span>
<span>  assay_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    basal <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    uncoupled <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    maxresp <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    nonmito <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    no_glucose_glyc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    glucose_glyc <span class="op">=</span> <span class="st">"MITO"</span>,</span>
<span>    max_glyc <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span>,</span>
<span>  basal_tp <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  uncoupled_tp <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  maxresp_tp <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  nonmito_tp <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  no_glucose_glyc_tp <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  glucose_glyc_tp <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_glyc_tp <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="respiratory-control-ratio-rcr-and-glycolytic-capacity-gc-assay" role="tabpanel" aria-labelledby="respiratory-control-ratio-rcr-and-glycolytic-capacity-gc-assay-tab">

<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>partitioned_data <span class="ot">&lt;-</span> <span class="fu">partition_data</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  seahorse_rates,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">assay_types =</span> <span class="fu">list</span>(</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="at">basal =</span> <span class="st">"RCR"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="at">uncoupled =</span> <span class="st">"RCR"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="at">maxresp =</span> <span class="st">"RCR,"</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    <span class="at">nonmito =</span> <span class="st">"RCR"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    <span class="at">no_glucose_glyc =</span> <span class="cn">NA</span>,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    <span class="at">glucose_glyc =</span> <span class="st">"GC"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    <span class="at">max_glyc =</span> <span class="st">"GC"</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  ),</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  <span class="at">basal_tp =</span> <span class="dv">3</span>,</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="at">uncoupled_tp =</span> <span class="dv">6</span>,</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  <span class="at">maxresp_tp =</span> <span class="dv">8</span>,</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="at">nonmito_tp =</span> <span class="dv">12</span>,</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>  <span class="at">no_glucose_glyc =</span> <span class="cn">NA</span>,</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>  <span class="at">glucose_glyc_tp =</span> <span class="dv">3</span>,</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  <span class="at">max_glyc_tp =</span> <span class="dv">9</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="section"></h4>
<p>Note that the time point parameters (<code>maxresp_tp</code> and
<code>no_glucose_glyc_tp</code>) also need to be changed
accordingly.</p>
<p>The <code>get_energetics</code> function requires pH,
pK<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi></mi><mi>a</mi></msub><annotation encoding="application/x-tex">_a</annotation></semantics></math>
and buffer values.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energetics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_energetics.html">get_energetics</a></span><span class="op">(</span><span class="va">partitioned_data</span>, ph <span class="op">=</span> <span class="fl">7.4</span>, pka <span class="op">=</span> <span class="fl">6.093</span>, buffer <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></span></code></pre></div>
<p>For more information on the calculations see the article on <a href="atp_calculation.html">ATP calculations</a>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<div class="section level3">
<h3 id="bioenergetic-scope-plot">Bioenergetic scope plot<a class="anchor" aria-label="anchor" href="#bioenergetic-scope-plot"></a>
</h3>
<p>The <code>bioscope_plot</code> function plots a 2D representation of
group “bioenergetic scope.” Bioenergetic scope describes the theoretical
energetic space in which a matrix operates. The bioenergetic scope
coordinates are JATP from OXPHOS on the y-axis and JATP from glycolysis
on the x-axis. The points represent mean basal and/or max JATP from
OXPHOS and glycolysis and the vertical and horizontal lines represent
the standard deviation or confidence interval of JATP from OXPHOS or
glycolysis, respectively.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">bioscope</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bioscope_plot.html">bioscope_plot</a></span><span class="op">(</span><span class="va">energetics</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/bioscope_plot-1.png" width="700"></p>
</div>
<div class="section level3 tabset">
<h3 class="tabset" id="rate-plots">Rate plots<a class="anchor" aria-label="anchor" href="#rate-plots"></a>
</h3>
<p>The <code>rate_plot</code> function provides an overview of OCR or
ECAR for each assay type over time, which enables cross-group energetic
comparisons before and after the addition of energetic-modulating
compounds. The <code>rate_plot</code> line represents mean group OCR or
ECAR over the sequential measurements (x-axis) and the shaded variance
region represents standard deviation or specified confidence
interval.</p>


<ul class="nav nav-tabs" id="rate-plots" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#oxygen-consumption-rate-ocr" id="oxygen-consumption-rate-ocr-tab" type="button" role="tab" aria-controls="oxygen-consumption-rate-ocr" aria-selected="true" class="active nav-link">Oxygen consumption rate (OCR)</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#extracellular-acidification-rate-ecar" id="extracellular-acidification-rate-ecar-tab" type="button" role="tab" aria-controls="extracellular-acidification-rate-ecar" aria-selected="false" class="nav-link">Extracellular Acidification Rate (ECAR)</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="oxygen-consumption-rate-ocr" role="tabpanel" aria-labelledby="oxygen-consumption-rate-ocr-tab">

<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ocr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rate_plot.html">rate_plot</a></span><span class="op">(</span><span class="va">seahorse_rates</span>, measure <span class="op">=</span> <span class="st">"OCR"</span>, assay <span class="op">=</span> <span class="st">"MITO"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/ocr-1.png" width="700"></p>
</div>
<div class="tab-pane" id="extracellular-acidification-rate-ecar" role="tabpanel" aria-labelledby="extracellular-acidification-rate-ecar-tab">

<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ecar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rate_plot.html">rate_plot</a></span><span class="op">(</span><span class="va">seahorse_rates</span>, measure <span class="op">=</span> <span class="st">"ECAR"</span>, assay <span class="op">=</span> <span class="st">"GLYCO"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/ecar-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level3 tabset">
<h3 class="tabset" id="atp-plots">ATP plots<a class="anchor" aria-label="anchor" href="#atp-plots"></a>
</h3>
<p>The <code>atp_plot</code> function plots group JATP values, which
enables cross-group OXPHOS and glycolytic JATP comparisons at basal and
max conditions. The <code>atp_plot</code> symbols represent the mean
basal or max JATP from OXPHOS or glycolysis, and the crossbar boundaries
represent the standard deviation or confidence interval JATP
variance.</p>




<ul class="nav nav-tabs" id="atp-plots" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#basal-glycolysis" id="basal-glycolysis-tab" type="button" role="tab" aria-controls="basal-glycolysis" aria-selected="true" class="active nav-link">Basal glycolysis</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#basal-respiration" id="basal-respiration-tab" type="button" role="tab" aria-controls="basal-respiration" aria-selected="false" class="nav-link">Basal respiration</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#maximal-glycolysis" id="maximal-glycolysis-tab" type="button" role="tab" aria-controls="maximal-glycolysis" aria-selected="false" class="nav-link">Maximal glycolysis</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#maximal-respiration" id="maximal-respiration-tab" type="button" role="tab" aria-controls="maximal-respiration" aria-selected="false" class="nav-link">Maximal respiration</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="basal-glycolysis" role="tabpanel" aria-labelledby="basal-glycolysis-tab">

<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">basal_glyc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/atp_plot.html">atp_plot</a></span><span class="op">(</span><span class="va">energetics</span>, basal_vs_max <span class="op">=</span> <span class="st">"basal"</span>, glyc_vs_resp <span class="op">=</span> <span class="st">"glyc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/basal_glyc-1.png" width="700"></p>
</div>
<div class="tab-pane" id="basal-respiration" role="tabpanel" aria-labelledby="basal-respiration-tab">

<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">basal_resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/atp_plot.html">atp_plot</a></span><span class="op">(</span><span class="va">energetics</span>, basal_vs_max <span class="op">=</span> <span class="st">"basal"</span>, glyc_vs_resp <span class="op">=</span> <span class="st">"resp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/basal_resp-1.png" width="700"></p>
</div>
<div class="tab-pane" id="maximal-glycolysis" role="tabpanel" aria-labelledby="maximal-glycolysis-tab">

<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">max_glyc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/atp_plot.html">atp_plot</a></span><span class="op">(</span><span class="va">energetics</span>, basal_vs_max <span class="op">=</span> <span class="st">"max"</span>, glyc_vs_resp <span class="op">=</span> <span class="st">"glyc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/max_glyc-1.png" width="700"></p>
</div>
<div class="tab-pane" id="maximal-respiration" role="tabpanel" aria-labelledby="maximal-respiration-tab">

<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">max_resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/atp_plot.html">atp_plot</a></span><span class="op">(</span><span class="va">energetics</span>, basal_vs_max <span class="op">=</span> <span class="st">"max"</span>, glyc_vs_resp <span class="op">=</span> <span class="st">"resp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/max_resp-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="customizing-plots">Customizing plots<a class="anchor" aria-label="anchor" href="#customizing-plots"></a>
</h3>
<p>CEAS is designed to work with existing <code>ggplot2</code>
customization functionality and doesn’t include more than shape and size
options for its plots.</p>
<p>For example, to change the colors used in the plot, simply make the
plot and add the custom colors you’d like:</p>
<div class="section level4">
<h4 id="colors">Colors<a class="anchor" aria-label="anchor" href="#colors"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e36500"</span>, <span class="st">"#b52356"</span>, <span class="st">"#3cb62d"</span>, <span class="st">"#328fe1"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bioscope</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>  values <span class="op">=</span> <span class="va">custom_colors</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ocr</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>  values <span class="op">=</span> <span class="va">custom_colors</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level4 tabset">
<h4 class="tabset" id="labels">Labels<a class="anchor" aria-label="anchor" href="#labels"></a>
</h4>


<ul class="nav nav-tabs" id="labels" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#change-axis-labels" id="change-axis-labels-tab" type="button" role="tab" aria-controls="change-axis-labels" aria-selected="true" class="active nav-link">Change axis labels</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#change-label-size" id="change-label-size-tab" type="button" role="tab" aria-controls="change-label-size" aria-selected="false" class="nav-link">Change label size</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="change-axis-labels" role="tabpanel" aria-labelledby="change-axis-labels-tab">

<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecar</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time points"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="tab-pane" id="change-label-size" role="tabpanel" aria-labelledby="change-label-size-tab">

<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">basal_glyc</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ceas_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level4">
<h4 id="editing-functions">Editing functions<a class="anchor" aria-label="anchor" href="#editing-functions"></a>
</h4>
<p>We are working on making the plots as customizable as possible.
However, if there are options that cannot be set in the calls to the
plotting functions or with <code>ggplot2</code> functions, you can get
the code used to make the plots by running the function name without
parenthesis and modify it. Further, since every step in the ceas
workflow provides a dataset, you can run the modified function or your
own custom plotting functions on those datasets.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate_plot</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">function</span> <span class="op">(</span><span class="va">seahorse_rates</span>, <span class="va">measure</span> <span class="op">=</span> <span class="st">"OCR"</span>, <span class="va">assay</span> <span class="op">=</span> <span class="st">"MITO"</span>, <span class="va">error_bar</span> <span class="op">=</span> <span class="st">"ci"</span>, </span>
<span>    <span class="va">conf_int</span> <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">group_label</span> <span class="op">=</span> <span class="st">"Experimental group"</span><span class="op">)</span> </span>
<span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span>`'measure' should be 'OCR' or 'ECAR'` <span class="op">=</span> <span class="va">measure</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OCR"</span>, <span class="st">"ECAR"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span>`'error_bar' should be 'sd' or 'ci'` <span class="op">=</span> <span class="va">error_bar</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sd"</span>, <span class="st">"ci"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span>`'conf_int' should be between 0 and 1` <span class="op">=</span> <span class="va">conf_int</span> <span class="op">&gt;</span> </span>
<span>        <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">conf_int</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">data_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Measurement"</span>, <span class="st">"Well"</span>, <span class="st">"OCR"</span>, <span class="st">"ECAR"</span>, <span class="st">"PER"</span>, </span>
<span>        <span class="st">"exp_group"</span>, <span class="st">"assay_type"</span>, <span class="st">"replicate"</span><span class="op">)</span></span>
<span>    <span class="va">missing_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">data_cols</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">seahorse_rates</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">missing_cols</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"'"</span>, <span class="va">missing_cols</span>, <span class="st">"'"</span>, <span class="st">" column was not found in input data\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">Measurement</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="va">exp_group</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="va">lower_bound</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="va">upper_bound</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_rate_summary.html">get_rate_summary</a></span><span class="op">(</span><span class="va">seahorse_rates</span>, <span class="va">measure</span>, <span class="va">assay</span>, </span>
<span>        <span class="va">error_bar</span>, <span class="va">conf_int</span><span class="op">)</span></span>
<span>    <span class="va">y_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>OCR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">assay</span>, <span class="st">" OCR (pmol/min)"</span><span class="op">)</span>, </span>
<span>        ECAR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">assay</span>, <span class="st">" ECAR (mpH/min)"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Measurement</span>, y <span class="op">=</span> <span class="va">mean</span>, color <span class="op">=</span> <span class="va">exp_group</span>, </span>
<span>        group <span class="op">=</span> <span class="va">exp_group</span>, fill <span class="op">=</span> <span class="va">exp_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower_bound</span>, ymax <span class="op">=</span> <span class="va">upper_bound</span><span class="op">)</span>, </span>
<span>            alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, </span>
<span>        <span class="fl">12</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"Measurement"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="va">y_labels</span><span class="op">[</span><span class="va">measure</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="va">group_label</span>, fill <span class="op">=</span> <span class="va">group_label</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In RStudio, you can run <code><a href="https://rdrr.io/r/utils/edit.html" class="external-link">utils::edit</a></code> to modify a
function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/edit.html" class="external-link">edit</a></span><span class="op">(</span><span class="va">rate_plot</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-mookerjee2017" class="csl-entry">
Mookerjee, Shona A., Akos A. Gerencser, David G. Nicholls, and Martin D.
Brand. 2017. <span>“Quantifying Intracellular Rates of Glycolytic and
Oxidative ATP Production and Consumption Using Extracellular Flux
Measurements.”</span> <em>Journal of Biological Chemistry</em> 292 (17):
7189–7207. <a href="https://doi.org/10.1074/jbc.M116.774471" class="external-link">https://doi.org/10.1074/jbc.M116.774471</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rachel House, James Eapen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
